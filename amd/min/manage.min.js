function render(e,t){const n=$(`#${t}_error`)[0];n.style.display="none";const r=$(`#${e}_btn`)[0],i=$(`#${t}_content`)[0];i.innerHTML="",i.style.display="none";let s=[];if("table"===t?s=["cd","al","nau","eh","nuh"]:"chart"===t&&(s=["eu"],$("#chart_div")[0].style.display="none"),s!=[])if(r.innerText.includes("Show")){s.forEach(e=>{$(`#${e}_btn`)[0].innerText=$(`#${e}_btn`)[0].innerText.replace("Hide","Show")}),r.innerText=r.innerText.replace("Show","Hide");const o=new XMLHttpRequest;o.open("POST",`./classes/inc/${t}_render.inc.php`,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);if(e.error)n.innerText=e.error,n.style.display="block";else if(e.return){if(i.innerHTML=e.return,"chart"!=t&&(i.style.display="block"),e.script){let t=document.createElement("script");t.innerHTML="drawChart([",e.script.forEach(e=>{t.innerHTML+="["+e[0]+',"'+e[1]+'"],'}),t.innerHTML=t.innerHTML.slice(0,-1),t.innerHTML+="])",i.appendChild(t)}"chart"===t&&($("#chart_div")[0].style.display="block")}else n.innerText="Loading error",n.style.display="block"}else n.innerText="Connection error.",n.style.display="block"},o.send(`type=${e}`)}else r.innerText.includes("Hide")&&(r.innerText=r.innerText.replace("Hide","Show"))}function history_filter(e){const t=$("#hf_error")[0],n=$(`#${e}_tbody`)[0];if(n.innerHTML="",t.style.display="none","eh"==e||"nuh"==e){const r=$("#startdate")[0],i=$("#enddate")[0];if(""==r.value)t.innerText="No start date provided",t.style.display="block";else if(""==i.value)t.innerText="No end date provided",t.style.display="block";else{const s=`type=${e}&sd=${r.value}&ed=${i.value}`,o=new XMLHttpRequest;o.open("POST","./classes/inc/history_render.inc.php",!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);e.error?(t.innerText=e.error,t.style.display="block"):e.return?n.innerHTML=e.return:(t.innerText="No search results",t.style.display="block")}else t.innerText="Connection error",t.style.display="block"},o.send(s)}}}function getRandomColor(){let e="#";for(let t=0;t<6;t++)e+=letters[Math.floor(16*Math.random())];return e}function drawChart(e){current=[];const t=$("#chart_display")[0];t.innerHTML="";const n=canvas.width/int,r=canvas.height/int,i=.9*Math.min(n,r);total=e.reduce((e,t)=>e+t[0],0);let s=0,o=[];e.forEach(e=>{const c=e[0]/total*int*Math.PI;let l=getRandomColor();if(o.includes(l))do{l=getRandomColor()}while(o.includes(l));o.push(l),ctx.fillStyle=l,ctx.beginPath(),ctx.moveTo(n,r),ctx.arc(n,r,i,s,s+c),ctx.lineTo(n,r),ctx.fill(),s+=c;let a="";for(let e=0;e<3;e++)a+=letters[Math.floor(16*Math.random())];t.innerHTML+=`<p id="cc_${e[1]+a}" filter='false' class='cc-text c-pointer mr-1' onclick='filter("${e[1]+a}")'><canvas style="width:35px;height:15px;background-color:${l};margin-right:.25rem;"></canvas><span>${e[1]}</span></p>`,current.push([e[0],e[1]+a,l])})}function filter(e){const t=document.getElementById(`cc_${e}`);"true"==t.getAttribute("filter")?(t.style="",t.setAttribute("filter","false")):(t.style="text-decoration: line-through;",t.setAttribute("filter","true"));const n=document.querySelectorAll(".cc-text");data=[],n.forEach(function(e,t){"false"==e.getAttribute("filter")&&data.push(current[t])}),ctx.clearRect(0,0,canvas.width,canvas.height);let r=0;const i=canvas.width/2,s=canvas.height/2,o=.9*Math.min(i,s);total=data.reduce((e,t)=>e+t[0],0),data.forEach(e=>{const t=e[0]/total*2*Math.PI;ctx.fillStyle=e[2],ctx.beginPath(),ctx.moveTo(i,s),ctx.arc(i,s,o,r,r+t),ctx.lineTo(i,s),ctx.fill(),r+=t})}const sorh=$("#showorhide")[0];sorh.addEventListener("click",()=>{const e=$("#courselist")[0];e.style.display="none"===e.style.display?"block":"none",sorh.innerText=sorh.innerText.includes("Show")?sorh.innerText.replace("Show","Hide"):sorh.innerText.replace("Hide","Show")});const canvas=$("#chart_canvas")[0],ctx=canvas.getContext("2d"),int=2,letters="0123456789ABCDEF";let current=[];const showcd=$("#show_cd")[0];showcd.addEventListener("click",()=>{const e=$("#chart_content")[0];"none"==e.style.display?(e.style.display="block",showcd.innerText="Hide chart data"):"block"==e.style.display&&(e.style.display="none",showcd.innerText="Show chart data")});