function render(e,t){const n=$(`#${t}_error`)[0];n.style.display="none";const r=$(`#${e}_btn`)[0],o=$(`#${t}_content`)[0];o.innerHTML="",o.style.display="none";let i=[];if("table"===t?i=["cd","al","nau","eh","nuh"]:"chart"===t&&(i=["eu"],$("#chart_div")[0].style.display="none"),i!=[])if(r.innerText.includes("Show")){i.forEach(e=>{$(`#${e}_btn`)[0].innerText=$(`#${e}_btn`)[0].innerText.replace("Hide","Show")}),r.innerText=r.innerText.replace("Show","Hide");const s=new XMLHttpRequest;s.open("POST",`./classes/inc/${t}_render.inc.php`,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);if(e.error)n.innerText=e.error,n.style.display="block";else if(e.return){if(o.innerHTML=e.return,e.script){let t=document.createElement("script");t.innerHTML="drawChart([",e.script.forEach(e=>{t.innerHTML+="["+e[0]+',"'+e[1]+'"],'}),t.innerHTML=t.innerHTML.slice(0,-1),t.innerHTML+="])",console.log(t),o.appendChild(t)}"chart"===t&&($("#chart_div")[0].style.display="block")}else n.innerText="Loading error",n.style.display="block"}else n.innerText="Connection error.",n.style.display="block"},s.send(`type=${e}`)}else r.innerText.includes("Hide")&&(r.innerText=r.innerText.replace("Hide","Show"))}function history_filter(e){const t=$("#hf_error")[0],n=$(`#${e}_tbody`)[0];if(n.innerHTML="",t.style.display="none","eh"==e||"nuh"==e){const r=$("#startdate")[0],o=$("#enddate")[0];if(""==r.value)t.innerText="No start date provided",t.style.display="block";else if(""==o.value)t.innerText="No end date provided",t.style.display="block";else{const i=`type=${e}&sd=${r.value}&ed=${o.value}`,s=new XMLHttpRequest;s.open("POST","./classes/inc/history_render.inc.php",!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onload=function(){if(200==this.status){const e=JSON.parse(this.responseText);e.error?(t.innerText=e.error,t.style.display="block"):e.return?n.innerHTML=e.return:(t.innerText="No search results",t.style.display="block")}else t.innerText="Connection error",t.style.display="block"},s.send(i)}}}function getRandomColor(){let e="#";for(let t=0;t<6;t++)e+=letters[Math.floor(16*Math.random())];return e}function drawChart(e){current=[];const t=$("#chart_display")[0];t.innerHTML="";const n=canvas.width/int,r=canvas.height/int,o=.9*Math.min(n,r);total=e.reduce((e,t)=>e+t[0],0);let i=0,s=[];e.forEach(e=>{const c=e[0]/total*int*Math.PI;let l=getRandomColor();if(s.includes(l))do{l=getRandomColor()}while(s.includes(l));s.push(l),ctx.fillStyle=l,ctx.beginPath(),ctx.moveTo(n,r),ctx.arc(n,r,o,i,i+c),ctx.lineTo(n,r),ctx.fill(),i+=c;let a="";for(let e=0;e<3;e++)a+=letters[Math.floor(16*Math.random())];t.innerHTML+=`<p id="cc_${e[1]+a}" filter='false' class='cc-text c-pointer mr-1' onclick='filter("${e[1]+a}")'><canvas style="width:35px;height:15px;background-color:${l};margin-right:.25rem;"></canvas><span>${e[1]}</span></p>`,current.push([e[0],e[1]+a,l])}),console.log(e)}function filter(e){const t=document.getElementById(`cc_${e}`);"true"==t.getAttribute("filter")?(t.style="",t.setAttribute("filter","false")):(t.style="text-decoration: line-through;",t.setAttribute("filter","true"));const n=document.querySelectorAll(".cc-text");data=[],n.forEach(function(e,t){"false"==e.getAttribute("filter")&&data.push(current[t])}),ctx.clearRect(0,0,canvas.width,canvas.height);let r=0;const o=canvas.width/2,i=canvas.height/2,s=.9*Math.min(o,i);total=data.reduce((e,t)=>e+t[0],0),data.forEach(e=>{const t=e[0]/total*2*Math.PI;ctx.fillStyle=e[2],ctx.beginPath(),ctx.moveTo(o,i),ctx.arc(o,i,s,r,r+t),ctx.lineTo(o,i),ctx.fill(),r+=t})}const sorh=$("#showorhide")[0];sorh.addEventListener("click",()=>{const e=$("#courselist")[0];e.style.display="none"===e.style.display?"block":"none",sorh.innerText=sorh.innerText.includes("Show")?sorh.innerText.replace("Show","Hide"):sorh.innerText.replace("Hide","Show")});const canvas=$("#chart_canvas")[0],ctx=canvas.getContext("2d"),int=2,letters="0123456789ABCDEF";let current=[];const showcd=$("#show_cd")[0];showcd.addEventListener("click",()=>{const e=$("#chart_content")[0];"none"==e.style.display?(e.style.display="block",showcd.innerText="Hide chart data"):"block"==e.style.display&&(e.style.display="none",showcd.innerText="Show chart data")});